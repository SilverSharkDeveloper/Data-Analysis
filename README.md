### Data-Analysis Side Project
### RFM ë¶„ì„
####  ì‚¬ìš©ìë³„ë¡œ ì–¼ë§ˆë‚˜ ìµœê·¼ì—, ì–¼ë§ˆë‚˜ ìì£¼, ì–¼ë§ˆë‚˜ ë§ì€ ê¸ˆì•¡ì„ ì§€ì¶œí–ˆëŠ”ì§€ì— ë”°ë¼ ì‚¬ìš©ìë“¤ì˜ ë¶„í¬ë¥¼ í™•ì¸í•  ìˆ˜ ìˆê³ , ì‚¬ìš©ì ê·¸ë£¹(ë˜ëŠ” ë“±ê¸‰)ì„ ë‚˜ëˆ„ì–´ ë¶„ë¥˜í•˜ëŠ” ë¶„ì„ ê¸°ë²•ì´ë‹¤. êµ¬ë§¤ ê°€ëŠ¥ì„±ì´ ë†’ì€ ê³ ê°ì„ ì„ ì •í•  ë•Œ ìš©ì´í•œ ë°ì´í„° ë¶„ì„ ë°©ë²•ì´ë©°, ì‚¬ìš©ìë“¤ì˜ í‰ì†Œ êµ¬ë§¤ íŒ¨í„´ì„ ê¸°ì¤€ìœ¼ë¡œ ë¶„ë¥˜ë¥¼ ì§„í–‰í•˜ê¸° ë•Œë¬¸ì— ê° ì‚¬ìš©ì ê·¸ë£¹ì˜ íŠ¹ì„±ì— ë”°ë¼ ì°¨ë³„í™”ëœ ë§ˆì¼€íŒ… ë©”ì„¸ì§€ë¥¼ ì „ë‹¬í•  ìˆ˜ ìˆë‹¤.

- Recency : ì–¼ë§ˆë‚˜ ìµœê·¼ì— êµ¬ë§¤í–ˆëŠ”ê°€
- Frequency : ì–¼ë§ˆë‚˜ ìì£¼ êµ¬ë§¤í–ˆëŠ”ê°€
- Monetary : ì–¼ë§ˆë‚˜ ë§ì€ ê¸ˆì•¡ì„ ì§€ì¶œí–ˆëŠ”ê°€

### ğŸ›’ì´ì»¤ë¨¸ìŠ¤ í”Œë«í¼ Aê¸°ì—…ì˜ RFM ë¶„ì„
ğŸ“Œì´ì»¤ë¨¸ìŠ¤: ì˜¨ë¼ì¸ì„ í†µí•´ ìƒí’ˆì´ë‚˜ ì„œë¹„ìŠ¤ë¥¼ ì‚¬ê³ íŒŒëŠ” ì„œë¹„ìŠ¤ (ì¿ íŒ¡, 11ë²ˆê°€, ë„¤ì´ë²„ ë“±)

 
<table style="width: 50%; margin-left:10px;">
    <caption>ê³ ê° ë¶„ì„</caption>
    <tr>
        <th>ì‚¬ìš©ì</th>
        <th>êµ¬ë§¤ íšŸìˆ˜</th>
        <th>êµ¬ë§¤ ê¸ˆì•¡</th>
        <th>ìµœê·¼ êµ¬ë§¤ì¼</th>
    </tr>
    <tr>
        <th>í•œë™ì„</th>
        <th>45</th>
        <th>1,980,000</th>
        <th>2ê°œì›” ì „</th>
    </tr>
    <tr>
        <th>ì£¼ì„ ìœ </th>
        <th>2</th>
        <th>45,320</th>
        <th>1ë…„ ì „</th>
    </tr>
</table>

##### ğŸ‘“ "í•œë™ì„" ê³ ê°ì„ VIPë¡œ ì„ ì •í•´ì„œ ì—°ë§ ì„ ë¬¼ì„ ì „ë‹¬í•˜ë©´, ì¶©ì„±ì‹¬ìˆëŠ” ê³ ê°ìœ¼ë¡œ ìœ ì§€í•  ìˆ˜ ìˆëŠ” ì „ëµì„ ì„¸ìš¸ ìˆ˜ë„ ìˆê³ ,<br> ğŸ« "ì£¼ì„ ìœ " ê³ ê°ì—ê²Œ í• ì¸ ì¿ í° ë“± ìì‚¬ì˜ í”Œë«í¼ì„ ì´ìš©í•  ê±°ë¦¬ë¥¼ ì „ë‹¬í•¨ìœ¼ë¡œì¨, êµ¬ë§¤ë¥¼ ìœ ë„í•  ìˆ˜ ìˆëŠ” ì „ëµì„ ì„¸ìš¸ ìˆ˜ë„ ìˆë‹¤.

####  RFMì„ ì‚¬ìš©í•˜ë©´ ì‚¬ìš©ìì˜ íŠ¹ì„±ë³„ë¡œ ê°ê¸° ë‹¤ë¥¸ ì •ì±…ì„ ì ìš©í•˜ê³  ì„œë¹„ìŠ¤ë¥¼ ë” ì˜ ì‚¬ìš©í•˜ê²Œë” ìœ ë„í•˜ëŠ” ì „ëµì„ ì„¸ì›Œë³¼ ìˆ˜ê°€ ìˆë‹¤.

### ë°ì´í„°ì…‹ í™•ì¸



```python
import pandas as pd
#ì—‘ì…€ ë˜ëŠ” csvíŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°(csv íŒŒì¼ì„ ì½ì–´ì˜¬ ë•ŒëŠ” êµ¬ë¶„ì ì´ ë¬´ì—‡ì¸ì§€ íŒë‹¨í•´ì„œ ì‘ì„±í•´ì£¼ì–´ì—¬í•¨ ì½¤ë§ˆ(,)ê°€ ë””í´íŠ¸
#ì•¡ì…€ì€ ì´ë¯¸ êµ¬ë¶„ë˜ì–´ ìˆìœ¼ë¯€ë¡œ ì ì„í•„ìš” ì—†ìŒ )
retail_orders_df = pd.read_excel('./datasets/Retailer Sales Orders - EU-UK.xlsx')
display(retail_orders_df)

```


<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Order</th>
      <th>Item Name</th>
      <th>Quantity</th>
      <th>Date</th>
      <th>Time</th>
      <th>Price</th>
      <th>Customer ID</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>540040</td>
      <td>FELT FARM ANIMAL WHITE BUNNY</td>
      <td>48</td>
      <td>2011-01-04 14:20:00</td>
      <td>2011-01-04 14:20:00</td>
      <td>0.19</td>
      <td>12483.0</td>
      <td>Sweden</td>
    </tr>
    <tr>
      <th>1</th>
      <td>540040</td>
      <td>EAU DE NIL LOVE BIRD CANDLE</td>
      <td>24</td>
      <td>2011-01-04 14:20:00</td>
      <td>2011-01-04 14:20:00</td>
      <td>0.42</td>
      <td>12483.0</td>
      <td>Sweden</td>
    </tr>
    <tr>
      <th>2</th>
      <td>540040</td>
      <td>IVORY LOVE BIRD CANDLE</td>
      <td>24</td>
      <td>2011-01-04 14:20:00</td>
      <td>2011-01-04 14:20:00</td>
      <td>0.42</td>
      <td>12483.0</td>
      <td>Sweden</td>
    </tr>
    <tr>
      <th>3</th>
      <td>540040</td>
      <td>BLACK LOVE BIRD CANDLE</td>
      <td>24</td>
      <td>2011-01-04 14:20:00</td>
      <td>2011-01-04 14:20:00</td>
      <td>0.42</td>
      <td>12483.0</td>
      <td>Sweden</td>
    </tr>
    <tr>
      <th>4</th>
      <td>540040</td>
      <td>FELTCRAFT DOLL ROSIE</td>
      <td>12</td>
      <td>2011-01-04 14:20:00</td>
      <td>2011-01-04 14:20:00</td>
      <td>2.95</td>
      <td>12483.0</td>
      <td>Sweden</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>470645</th>
      <td>581585</td>
      <td>FAIRY TALE COTTAGE NIGHT LIGHT</td>
      <td>12</td>
      <td>2011-12-09 12:31:00</td>
      <td>2011-12-09 12:31:00</td>
      <td>1.95</td>
      <td>15804.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>470646</th>
      <td>581586</td>
      <td>LARGE CAKE STAND  HANGING STRAWBERY</td>
      <td>8</td>
      <td>2011-12-09 12:49:00</td>
      <td>2011-12-09 12:49:00</td>
      <td>2.95</td>
      <td>13113.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>470647</th>
      <td>581586</td>
      <td>SET OF 3 HANGING OWLS OLLIE BEAK</td>
      <td>24</td>
      <td>2011-12-09 12:49:00</td>
      <td>2011-12-09 12:49:00</td>
      <td>1.25</td>
      <td>13113.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>470648</th>
      <td>581586</td>
      <td>RED RETROSPOT ROUND CAKE TINS</td>
      <td>24</td>
      <td>2011-12-09 12:49:00</td>
      <td>2011-12-09 12:49:00</td>
      <td>8.95</td>
      <td>13113.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>470649</th>
      <td>581586</td>
      <td>DOORMAT RED RETROSPOT</td>
      <td>10</td>
      <td>2011-12-09 12:49:00</td>
      <td>2011-12-09 12:49:00</td>
      <td>7.08</td>
      <td>13113.0</td>
      <td>United Kingdom</td>
    </tr>
  </tbody>
</table>
<p>470650 rows Ã— 8 columns</p>
</div>


### ì»¬ëŸ¼ë³„ ê°¯ìˆ˜, í‰ê· , ìµœì†Ÿê°’, 4ë¶„ìœ„ë¶„í¬, ìµœëŒ“ê°’, í‘œì¤€í¸ì°¨ í™•ì¸í•˜ê¸°



```python
#ì»¬ëŸ¼ë³„ ê°¯ìˆ˜, í‰ê· , ìµœì†Ÿê°’, 4ë¶„ìœ„ë¶„í¬, ìµœëŒ“ê°’, í‘œì¤€í¸ì°¨ í™•ì¸í•˜ê¸°
display(retail_orders_df.describe().T)
```


<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
      <th>std</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Order</th>
      <td>470650.0</td>
      <td>561860.118721</td>
      <td>539993.0</td>
      <td>550987.0</td>
      <td>562592.0</td>
      <td>572758.0</td>
      <td>581587.0</td>
      <td>12347.899552</td>
    </tr>
    <tr>
      <th>Quantity</th>
      <td>470650.0</td>
      <td>10.338173</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>10.0</td>
      <td>80995.0</td>
      <td>164.392408</td>
    </tr>
    <tr>
      <th>Date</th>
      <td>470650</td>
      <td>2011-07-22 11:00:08.260660736</td>
      <td>2011-01-04 10:00:00</td>
      <td>2011-04-21 18:10:00</td>
      <td>2011-08-07 15:43:00</td>
      <td>2011-10-25 18:39:00</td>
      <td>2011-12-09 12:50:00</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Time</th>
      <td>470650</td>
      <td>2011-07-22 11:00:08.260660736</td>
      <td>2011-01-04 10:00:00</td>
      <td>2011-04-21 18:10:00</td>
      <td>2011-08-07 15:43:00</td>
      <td>2011-10-25 18:39:00</td>
      <td>2011-12-09 12:50:00</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Price</th>
      <td>470650.0</td>
      <td>3.222389</td>
      <td>0.04</td>
      <td>1.25</td>
      <td>2.08</td>
      <td>4.13</td>
      <td>649.5</td>
      <td>4.335077</td>
    </tr>
    <tr>
      <th>Customer ID</th>
      <td>355713.0</td>
      <td>15346.934967</td>
      <td>12346.0</td>
      <td>14005.0</td>
      <td>15296.0</td>
      <td>16837.0</td>
      <td>18287.0</td>
      <td>1695.614811</td>
    </tr>
  </tbody>
</table>
</div>


### ì»¬ëŸ¼ì˜ ìì„¸í•œ ì •ë³´ (null ê°œìˆ˜, dtype)í™•ì¸ ë° ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ í™•ì¸í•˜ê¸°


```python
print(retail_orders_df.info())
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 470650 entries, 0 to 470649
    Data columns (total 8 columns):
     #   Column       Non-Null Count   Dtype         
    ---  ------       --------------   -----         
     0   Order        470650 non-null  int64         
     1   Item Name    470650 non-null  object        
     2   Quantity     470650 non-null  int64         
     3   Date         470650 non-null  datetime64[ns]
     4   Time         470650 non-null  datetime64[ns]
     5   Price        470650 non-null  float64       
     6   Customer ID  355713 non-null  float64       
     7   Country      470650 non-null  object        
    dtypes: datetime64[ns](2), float64(2), int64(2), object(2)
    memory usage: 28.7+ MB
    None
    

### ì»¬ëŸ¼ë¶„ì„
> Order : ì£¼ë¬¸ë²ˆí˜¸  
Item Name : ìƒí’ˆëª…  
Quantity : ì£¼ë¬¸ ê°¯ìˆ˜  
Date : ì£¼ë¬¸ ë‚ ì§œ  
Time : ì£¼ë¬¸ ì‹œê°„  
Price : ìƒí’ˆ ê°€ê²©  
Customer ID : ê³ ê° ë²ˆí˜¸  
Country : ì£¼ë¬¸ ë‚˜ë¼ 

### ì¤‘ë³µ ë°ì´í„° ì²˜ë¦¬


```python
#ì¤‘ë³µí–‰ ê°¯ìˆ˜ í™•ì¸
retail_orders_df.duplicated().sum()

#ì¤‘ë³µí–‰ ì œê±° -> íŒŒë¼ë¯¸í„°ì— ì»¬ëŸ¼ëª… ì „ë‹¬ ì‹œ ì»¬ëŸ¼ ê°’ì´ ê°™ìœ¼ë©´ ê°™ë‹¤ê³  íŒë‹¨ ì•„ë¬´ê²ƒë„ ì „ë‹¬í•˜ì§€ ì•Šìœ¼ë©´ ëª¨ë“  ì»¬ëŸ¼ê°’ì´ ê°™ì•„ì•¼ ê°™ë‹¤ê³  íŒë‹¨
retail_orders_df.drop_duplicates(inplace=True)
display(retail_orders_df)

#ì¸ë±ìŠ¤ ì¬ìƒì„± -> dropì˜µì…˜ì— trueë¥¼ ì£¼ë©´ ê¸°ì¡´ ì¸ë±ìŠ¤ê°€ ì œê±°ë˜ê³  falseë¥¼ ì£¼ë©´ ê¸°ì¡´ì¸ë±ìŠ¤ê°€ ì»¬ëŸ¼ìœ¼ë¡œ ì¶”ê°€ë¨
retail_orders_df.reset_index(drop=True,inplace=True)
display(retail_orders_df)
```


<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Order</th>
      <th>Item Name</th>
      <th>Quantity</th>
      <th>Date</th>
      <th>Time</th>
      <th>Price</th>
      <th>Customer ID</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>540040</td>
      <td>FELT FARM ANIMAL WHITE BUNNY</td>
      <td>48</td>
      <td>2011-01-04 14:20:00</td>
      <td>2011-01-04 14:20:00</td>
      <td>0.19</td>
      <td>12483.0</td>
      <td>Sweden</td>
    </tr>
    <tr>
      <th>1</th>
      <td>540040</td>
      <td>EAU DE NIL LOVE BIRD CANDLE</td>
      <td>24</td>
      <td>2011-01-04 14:20:00</td>
      <td>2011-01-04 14:20:00</td>
      <td>0.42</td>
      <td>12483.0</td>
      <td>Sweden</td>
    </tr>
    <tr>
      <th>2</th>
      <td>540040</td>
      <td>IVORY LOVE BIRD CANDLE</td>
      <td>24</td>
      <td>2011-01-04 14:20:00</td>
      <td>2011-01-04 14:20:00</td>
      <td>0.42</td>
      <td>12483.0</td>
      <td>Sweden</td>
    </tr>
    <tr>
      <th>3</th>
      <td>540040</td>
      <td>BLACK LOVE BIRD CANDLE</td>
      <td>24</td>
      <td>2011-01-04 14:20:00</td>
      <td>2011-01-04 14:20:00</td>
      <td>0.42</td>
      <td>12483.0</td>
      <td>Sweden</td>
    </tr>
    <tr>
      <th>4</th>
      <td>540040</td>
      <td>FELTCRAFT DOLL ROSIE</td>
      <td>12</td>
      <td>2011-01-04 14:20:00</td>
      <td>2011-01-04 14:20:00</td>
      <td>2.95</td>
      <td>12483.0</td>
      <td>Sweden</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>470645</th>
      <td>581585</td>
      <td>FAIRY TALE COTTAGE NIGHT LIGHT</td>
      <td>12</td>
      <td>2011-12-09 12:31:00</td>
      <td>2011-12-09 12:31:00</td>
      <td>1.95</td>
      <td>15804.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>470646</th>
      <td>581586</td>
      <td>LARGE CAKE STAND  HANGING STRAWBERY</td>
      <td>8</td>
      <td>2011-12-09 12:49:00</td>
      <td>2011-12-09 12:49:00</td>
      <td>2.95</td>
      <td>13113.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>470647</th>
      <td>581586</td>
      <td>SET OF 3 HANGING OWLS OLLIE BEAK</td>
      <td>24</td>
      <td>2011-12-09 12:49:00</td>
      <td>2011-12-09 12:49:00</td>
      <td>1.25</td>
      <td>13113.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>470648</th>
      <td>581586</td>
      <td>RED RETROSPOT ROUND CAKE TINS</td>
      <td>24</td>
      <td>2011-12-09 12:49:00</td>
      <td>2011-12-09 12:49:00</td>
      <td>8.95</td>
      <td>13113.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>470649</th>
      <td>581586</td>
      <td>DOORMAT RED RETROSPOT</td>
      <td>10</td>
      <td>2011-12-09 12:49:00</td>
      <td>2011-12-09 12:49:00</td>
      <td>7.08</td>
      <td>13113.0</td>
      <td>United Kingdom</td>
    </tr>
  </tbody>
</table>
<p>465897 rows Ã— 8 columns</p>
</div>



<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Order</th>
      <th>Item Name</th>
      <th>Quantity</th>
      <th>Date</th>
      <th>Time</th>
      <th>Price</th>
      <th>Customer ID</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>540040</td>
      <td>FELT FARM ANIMAL WHITE BUNNY</td>
      <td>48</td>
      <td>2011-01-04 14:20:00</td>
      <td>2011-01-04 14:20:00</td>
      <td>0.19</td>
      <td>12483.0</td>
      <td>Sweden</td>
    </tr>
    <tr>
      <th>1</th>
      <td>540040</td>
      <td>EAU DE NIL LOVE BIRD CANDLE</td>
      <td>24</td>
      <td>2011-01-04 14:20:00</td>
      <td>2011-01-04 14:20:00</td>
      <td>0.42</td>
      <td>12483.0</td>
      <td>Sweden</td>
    </tr>
    <tr>
      <th>2</th>
      <td>540040</td>
      <td>IVORY LOVE BIRD CANDLE</td>
      <td>24</td>
      <td>2011-01-04 14:20:00</td>
      <td>2011-01-04 14:20:00</td>
      <td>0.42</td>
      <td>12483.0</td>
      <td>Sweden</td>
    </tr>
    <tr>
      <th>3</th>
      <td>540040</td>
      <td>BLACK LOVE BIRD CANDLE</td>
      <td>24</td>
      <td>2011-01-04 14:20:00</td>
      <td>2011-01-04 14:20:00</td>
      <td>0.42</td>
      <td>12483.0</td>
      <td>Sweden</td>
    </tr>
    <tr>
      <th>4</th>
      <td>540040</td>
      <td>FELTCRAFT DOLL ROSIE</td>
      <td>12</td>
      <td>2011-01-04 14:20:00</td>
      <td>2011-01-04 14:20:00</td>
      <td>2.95</td>
      <td>12483.0</td>
      <td>Sweden</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>465892</th>
      <td>581585</td>
      <td>FAIRY TALE COTTAGE NIGHT LIGHT</td>
      <td>12</td>
      <td>2011-12-09 12:31:00</td>
      <td>2011-12-09 12:31:00</td>
      <td>1.95</td>
      <td>15804.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>465893</th>
      <td>581586</td>
      <td>LARGE CAKE STAND  HANGING STRAWBERY</td>
      <td>8</td>
      <td>2011-12-09 12:49:00</td>
      <td>2011-12-09 12:49:00</td>
      <td>2.95</td>
      <td>13113.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>465894</th>
      <td>581586</td>
      <td>SET OF 3 HANGING OWLS OLLIE BEAK</td>
      <td>24</td>
      <td>2011-12-09 12:49:00</td>
      <td>2011-12-09 12:49:00</td>
      <td>1.25</td>
      <td>13113.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>465895</th>
      <td>581586</td>
      <td>RED RETROSPOT ROUND CAKE TINS</td>
      <td>24</td>
      <td>2011-12-09 12:49:00</td>
      <td>2011-12-09 12:49:00</td>
      <td>8.95</td>
      <td>13113.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>465896</th>
      <td>581586</td>
      <td>DOORMAT RED RETROSPOT</td>
      <td>10</td>
      <td>2011-12-09 12:49:00</td>
      <td>2011-12-09 12:49:00</td>
      <td>7.08</td>
      <td>13113.0</td>
      <td>United Kingdom</td>
    </tr>
  </tbody>
</table>
<p>465897 rows Ã— 8 columns</p>
</div>


### ê²°ì¸¡ì¹˜ ì²˜ë¦¬


```python
#ê²°ì¸¡ì¹˜ ê²€ì‚¬
retail_orders_df.isnull().sum()

#ê²°ì¸¡ì¹˜ í–‰ ì‚­ì œ
#ê²°ì¸¡ì¹˜ê°€ ê³ ê°ì˜ êµ¬ë¶„ì ì¸ CustomerIDì´ë¯€ë¡œ ë¶„ì„ í›„ ì—°ê³„ ë¶ˆê°€ëŠ¥.
# CustomerIDê°€ ìˆëŠ” í–‰ë§Œ ë¶„ì„í•˜ë„ë¡ í•œë‹¤

# retail_orders_df = retail_orders_df[~retail_orders_df.isnull()["Customer ID"]]
retail_orders_df.dropna(subset="Customer ID",inplace=True)
retail_orders_df.reset_index(inplace=True , drop=True)
retail_orders_df
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Order</th>
      <th>Item Name</th>
      <th>Quantity</th>
      <th>Date</th>
      <th>Time</th>
      <th>Price</th>
      <th>Customer ID</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>540040</td>
      <td>FELT FARM ANIMAL WHITE BUNNY</td>
      <td>48</td>
      <td>2011-01-04 14:20:00</td>
      <td>2011-01-04 14:20:00</td>
      <td>0.19</td>
      <td>12483.0</td>
      <td>Sweden</td>
    </tr>
    <tr>
      <th>1</th>
      <td>540040</td>
      <td>EAU DE NIL LOVE BIRD CANDLE</td>
      <td>24</td>
      <td>2011-01-04 14:20:00</td>
      <td>2011-01-04 14:20:00</td>
      <td>0.42</td>
      <td>12483.0</td>
      <td>Sweden</td>
    </tr>
    <tr>
      <th>2</th>
      <td>540040</td>
      <td>IVORY LOVE BIRD CANDLE</td>
      <td>24</td>
      <td>2011-01-04 14:20:00</td>
      <td>2011-01-04 14:20:00</td>
      <td>0.42</td>
      <td>12483.0</td>
      <td>Sweden</td>
    </tr>
    <tr>
      <th>3</th>
      <td>540040</td>
      <td>BLACK LOVE BIRD CANDLE</td>
      <td>24</td>
      <td>2011-01-04 14:20:00</td>
      <td>2011-01-04 14:20:00</td>
      <td>0.42</td>
      <td>12483.0</td>
      <td>Sweden</td>
    </tr>
    <tr>
      <th>4</th>
      <td>540040</td>
      <td>FELTCRAFT DOLL ROSIE</td>
      <td>12</td>
      <td>2011-01-04 14:20:00</td>
      <td>2011-01-04 14:20:00</td>
      <td>2.95</td>
      <td>12483.0</td>
      <td>Sweden</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>351001</th>
      <td>581585</td>
      <td>FAIRY TALE COTTAGE NIGHT LIGHT</td>
      <td>12</td>
      <td>2011-12-09 12:31:00</td>
      <td>2011-12-09 12:31:00</td>
      <td>1.95</td>
      <td>15804.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>351002</th>
      <td>581586</td>
      <td>LARGE CAKE STAND  HANGING STRAWBERY</td>
      <td>8</td>
      <td>2011-12-09 12:49:00</td>
      <td>2011-12-09 12:49:00</td>
      <td>2.95</td>
      <td>13113.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>351003</th>
      <td>581586</td>
      <td>SET OF 3 HANGING OWLS OLLIE BEAK</td>
      <td>24</td>
      <td>2011-12-09 12:49:00</td>
      <td>2011-12-09 12:49:00</td>
      <td>1.25</td>
      <td>13113.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>351004</th>
      <td>581586</td>
      <td>RED RETROSPOT ROUND CAKE TINS</td>
      <td>24</td>
      <td>2011-12-09 12:49:00</td>
      <td>2011-12-09 12:49:00</td>
      <td>8.95</td>
      <td>13113.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>351005</th>
      <td>581586</td>
      <td>DOORMAT RED RETROSPOT</td>
      <td>10</td>
      <td>2011-12-09 12:49:00</td>
      <td>2011-12-09 12:49:00</td>
      <td>7.08</td>
      <td>13113.0</td>
      <td>United Kingdom</td>
    </tr>
  </tbody>
</table>
<p>351006 rows Ã— 8 columns</p>
</div>



### ë°ì´í„° ì „ì²˜ë¦¬

> Date ì»¬ëŸ¼ê³¼ Time ì»¬ëŸ¼ì´ ì¤‘ë³µëœ ì»¬ëŸ¼ì´ë¯€ë¡œ Timeì»¬ëŸ¼ ì‚­ì œ  
RecencyëŠ” Dateì™€ í˜„ì¬ë‚ ì§œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì„¤ì •  
FrequencyëŠ” ê³ ê°ì´ ê°™ì€ ì£¼ë¬¸ë¹ˆë„ë¡œ ì„¤ì •  
MonetaryëŠ” ê³ ê°ë³„ Priceì™€ Quantityì˜ ê³±ìœ¼ë¡œ ì„¤ì •  


```python
retail_orders_df.drop("Time",axis=1,inplace=True)
retail_orders_df
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Order</th>
      <th>Item Name</th>
      <th>Quantity</th>
      <th>Date</th>
      <th>Price</th>
      <th>Customer ID</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>540040</td>
      <td>FELT FARM ANIMAL WHITE BUNNY</td>
      <td>48</td>
      <td>2011-01-04 14:20:00</td>
      <td>0.19</td>
      <td>12483.0</td>
      <td>Sweden</td>
    </tr>
    <tr>
      <th>1</th>
      <td>540040</td>
      <td>EAU DE NIL LOVE BIRD CANDLE</td>
      <td>24</td>
      <td>2011-01-04 14:20:00</td>
      <td>0.42</td>
      <td>12483.0</td>
      <td>Sweden</td>
    </tr>
    <tr>
      <th>2</th>
      <td>540040</td>
      <td>IVORY LOVE BIRD CANDLE</td>
      <td>24</td>
      <td>2011-01-04 14:20:00</td>
      <td>0.42</td>
      <td>12483.0</td>
      <td>Sweden</td>
    </tr>
    <tr>
      <th>3</th>
      <td>540040</td>
      <td>BLACK LOVE BIRD CANDLE</td>
      <td>24</td>
      <td>2011-01-04 14:20:00</td>
      <td>0.42</td>
      <td>12483.0</td>
      <td>Sweden</td>
    </tr>
    <tr>
      <th>4</th>
      <td>540040</td>
      <td>FELTCRAFT DOLL ROSIE</td>
      <td>12</td>
      <td>2011-01-04 14:20:00</td>
      <td>2.95</td>
      <td>12483.0</td>
      <td>Sweden</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>351001</th>
      <td>581585</td>
      <td>FAIRY TALE COTTAGE NIGHT LIGHT</td>
      <td>12</td>
      <td>2011-12-09 12:31:00</td>
      <td>1.95</td>
      <td>15804.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>351002</th>
      <td>581586</td>
      <td>LARGE CAKE STAND  HANGING STRAWBERY</td>
      <td>8</td>
      <td>2011-12-09 12:49:00</td>
      <td>2.95</td>
      <td>13113.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>351003</th>
      <td>581586</td>
      <td>SET OF 3 HANGING OWLS OLLIE BEAK</td>
      <td>24</td>
      <td>2011-12-09 12:49:00</td>
      <td>1.25</td>
      <td>13113.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>351004</th>
      <td>581586</td>
      <td>RED RETROSPOT ROUND CAKE TINS</td>
      <td>24</td>
      <td>2011-12-09 12:49:00</td>
      <td>8.95</td>
      <td>13113.0</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>351005</th>
      <td>581586</td>
      <td>DOORMAT RED RETROSPOT</td>
      <td>10</td>
      <td>2011-12-09 12:49:00</td>
      <td>7.08</td>
      <td>13113.0</td>
      <td>United Kingdom</td>
    </tr>
  </tbody>
</table>
<p>351006 rows Ã— 7 columns</p>
</div>



### Recencyêµ¬í•˜ê¸°


```python
from datetime import datetime
now = datetime.now()
retail_orders_df["Recency"] = (now - retail_orders_df["Date"]).dt.days
retail_orders_df

```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Order</th>
      <th>Item Name</th>
      <th>Quantity</th>
      <th>Date</th>
      <th>Price</th>
      <th>Customer ID</th>
      <th>Country</th>
      <th>Recency</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>540040</td>
      <td>FELT FARM ANIMAL WHITE BUNNY</td>
      <td>48</td>
      <td>2011-01-04 14:20:00</td>
      <td>0.19</td>
      <td>12483.0</td>
      <td>Sweden</td>
      <td>4657</td>
    </tr>
    <tr>
      <th>1</th>
      <td>540040</td>
      <td>EAU DE NIL LOVE BIRD CANDLE</td>
      <td>24</td>
      <td>2011-01-04 14:20:00</td>
      <td>0.42</td>
      <td>12483.0</td>
      <td>Sweden</td>
      <td>4657</td>
    </tr>
    <tr>
      <th>2</th>
      <td>540040</td>
      <td>IVORY LOVE BIRD CANDLE</td>
      <td>24</td>
      <td>2011-01-04 14:20:00</td>
      <td>0.42</td>
      <td>12483.0</td>
      <td>Sweden</td>
      <td>4657</td>
    </tr>
    <tr>
      <th>3</th>
      <td>540040</td>
      <td>BLACK LOVE BIRD CANDLE</td>
      <td>24</td>
      <td>2011-01-04 14:20:00</td>
      <td>0.42</td>
      <td>12483.0</td>
      <td>Sweden</td>
      <td>4657</td>
    </tr>
    <tr>
      <th>4</th>
      <td>540040</td>
      <td>FELTCRAFT DOLL ROSIE</td>
      <td>12</td>
      <td>2011-01-04 14:20:00</td>
      <td>2.95</td>
      <td>12483.0</td>
      <td>Sweden</td>
      <td>4657</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>351001</th>
      <td>581585</td>
      <td>FAIRY TALE COTTAGE NIGHT LIGHT</td>
      <td>12</td>
      <td>2011-12-09 12:31:00</td>
      <td>1.95</td>
      <td>15804.0</td>
      <td>United Kingdom</td>
      <td>4318</td>
    </tr>
    <tr>
      <th>351002</th>
      <td>581586</td>
      <td>LARGE CAKE STAND  HANGING STRAWBERY</td>
      <td>8</td>
      <td>2011-12-09 12:49:00</td>
      <td>2.95</td>
      <td>13113.0</td>
      <td>United Kingdom</td>
      <td>4318</td>
    </tr>
    <tr>
      <th>351003</th>
      <td>581586</td>
      <td>SET OF 3 HANGING OWLS OLLIE BEAK</td>
      <td>24</td>
      <td>2011-12-09 12:49:00</td>
      <td>1.25</td>
      <td>13113.0</td>
      <td>United Kingdom</td>
      <td>4318</td>
    </tr>
    <tr>
      <th>351004</th>
      <td>581586</td>
      <td>RED RETROSPOT ROUND CAKE TINS</td>
      <td>24</td>
      <td>2011-12-09 12:49:00</td>
      <td>8.95</td>
      <td>13113.0</td>
      <td>United Kingdom</td>
      <td>4318</td>
    </tr>
    <tr>
      <th>351005</th>
      <td>581586</td>
      <td>DOORMAT RED RETROSPOT</td>
      <td>10</td>
      <td>2011-12-09 12:49:00</td>
      <td>7.08</td>
      <td>13113.0</td>
      <td>United Kingdom</td>
      <td>4318</td>
    </tr>
  </tbody>
</table>
<p>351006 rows Ã— 8 columns</p>
</div>



### Monetaryêµ¬í•˜ê¸°


```python
retail_orders_df["Monetary"] =retail_orders_df["Quantity"] * retail_orders_df["Price"]
retail_orders_df
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Order</th>
      <th>Item Name</th>
      <th>Quantity</th>
      <th>Date</th>
      <th>Price</th>
      <th>Customer ID</th>
      <th>Country</th>
      <th>Recency</th>
      <th>Monetary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>540040</td>
      <td>FELT FARM ANIMAL WHITE BUNNY</td>
      <td>48</td>
      <td>2011-01-04 14:20:00</td>
      <td>0.19</td>
      <td>12483.0</td>
      <td>Sweden</td>
      <td>4657</td>
      <td>9.12</td>
    </tr>
    <tr>
      <th>1</th>
      <td>540040</td>
      <td>EAU DE NIL LOVE BIRD CANDLE</td>
      <td>24</td>
      <td>2011-01-04 14:20:00</td>
      <td>0.42</td>
      <td>12483.0</td>
      <td>Sweden</td>
      <td>4657</td>
      <td>10.08</td>
    </tr>
    <tr>
      <th>2</th>
      <td>540040</td>
      <td>IVORY LOVE BIRD CANDLE</td>
      <td>24</td>
      <td>2011-01-04 14:20:00</td>
      <td>0.42</td>
      <td>12483.0</td>
      <td>Sweden</td>
      <td>4657</td>
      <td>10.08</td>
    </tr>
    <tr>
      <th>3</th>
      <td>540040</td>
      <td>BLACK LOVE BIRD CANDLE</td>
      <td>24</td>
      <td>2011-01-04 14:20:00</td>
      <td>0.42</td>
      <td>12483.0</td>
      <td>Sweden</td>
      <td>4657</td>
      <td>10.08</td>
    </tr>
    <tr>
      <th>4</th>
      <td>540040</td>
      <td>FELTCRAFT DOLL ROSIE</td>
      <td>12</td>
      <td>2011-01-04 14:20:00</td>
      <td>2.95</td>
      <td>12483.0</td>
      <td>Sweden</td>
      <td>4657</td>
      <td>35.40</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>351001</th>
      <td>581585</td>
      <td>FAIRY TALE COTTAGE NIGHT LIGHT</td>
      <td>12</td>
      <td>2011-12-09 12:31:00</td>
      <td>1.95</td>
      <td>15804.0</td>
      <td>United Kingdom</td>
      <td>4318</td>
      <td>23.40</td>
    </tr>
    <tr>
      <th>351002</th>
      <td>581586</td>
      <td>LARGE CAKE STAND  HANGING STRAWBERY</td>
      <td>8</td>
      <td>2011-12-09 12:49:00</td>
      <td>2.95</td>
      <td>13113.0</td>
      <td>United Kingdom</td>
      <td>4318</td>
      <td>23.60</td>
    </tr>
    <tr>
      <th>351003</th>
      <td>581586</td>
      <td>SET OF 3 HANGING OWLS OLLIE BEAK</td>
      <td>24</td>
      <td>2011-12-09 12:49:00</td>
      <td>1.25</td>
      <td>13113.0</td>
      <td>United Kingdom</td>
      <td>4318</td>
      <td>30.00</td>
    </tr>
    <tr>
      <th>351004</th>
      <td>581586</td>
      <td>RED RETROSPOT ROUND CAKE TINS</td>
      <td>24</td>
      <td>2011-12-09 12:49:00</td>
      <td>8.95</td>
      <td>13113.0</td>
      <td>United Kingdom</td>
      <td>4318</td>
      <td>214.80</td>
    </tr>
    <tr>
      <th>351005</th>
      <td>581586</td>
      <td>DOORMAT RED RETROSPOT</td>
      <td>10</td>
      <td>2011-12-09 12:49:00</td>
      <td>7.08</td>
      <td>13113.0</td>
      <td>United Kingdom</td>
      <td>4318</td>
      <td>70.80</td>
    </tr>
  </tbody>
</table>
<p>351006 rows Ã— 9 columns</p>
</div>



### ê³ ê°ë³„ RFM êµ¬í•˜ê¸°


```python
retail_customer_rfm = retail_orders_df.groupby("Customer ID").agg({"Recency":"min","Customer ID":"count","Monetary":"sum"})
retail_customer_rfm = retail_customer_rfm.rename(columns={"Customer ID":"Frequency"})
retail_customer_rfm = retail_customer_rfm.reset_index()
retail_customer_rfm
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Customer ID</th>
      <th>Recency</th>
      <th>Frequency</th>
      <th>Monetary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12346.0</td>
      <td>4643</td>
      <td>1</td>
      <td>77183.60</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12349.0</td>
      <td>4336</td>
      <td>72</td>
      <td>1457.55</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12354.0</td>
      <td>4550</td>
      <td>58</td>
      <td>1079.40</td>
    </tr>
    <tr>
      <th>3</th>
      <td>12356.0</td>
      <td>4340</td>
      <td>58</td>
      <td>2487.43</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12358.0</td>
      <td>4319</td>
      <td>17</td>
      <td>928.06</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4100</th>
      <td>18280.0</td>
      <td>4595</td>
      <td>10</td>
      <td>180.60</td>
    </tr>
    <tr>
      <th>4101</th>
      <td>18281.0</td>
      <td>4498</td>
      <td>7</td>
      <td>80.82</td>
    </tr>
    <tr>
      <th>4102</th>
      <td>18282.0</td>
      <td>4325</td>
      <td>12</td>
      <td>178.05</td>
    </tr>
    <tr>
      <th>4103</th>
      <td>18283.0</td>
      <td>4321</td>
      <td>719</td>
      <td>2039.58</td>
    </tr>
    <tr>
      <th>4104</th>
      <td>18287.0</td>
      <td>4360</td>
      <td>70</td>
      <td>1837.28</td>
    </tr>
  </tbody>
</table>
<p>4105 rows Ã— 4 columns</p>
</div>



### ì •ê·œí™”(Normalization)
ê°’ì˜ ë²”ìœ„ë¥¼ 0~1ì‚¬ì´ë¡œ ë³€í™˜ì‹œì¼œ ëª¨ë“  ì»¬ëŸ¼ì˜ ë°ì´í„°ê°€ í‰ë“±í•˜ê²Œ ë§Œë“¤ì–´ì¤€ë‹¤.  
ì„œë¡œ ë‹¤ë¥¸ ë‹¨ìœ„ì˜ ê°’ì€ ë¹„êµëŒ€ìƒì´ ë  ìˆ˜ ì—†ë‹¤. ì˜ˆë¥¼ ë“¤ì–´, 80kgê³¼ 180cmëŠ” ë¹„êµí•  ìˆ˜ ì—†ê¸°ì— ì •ê·œí™”ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¹„êµí•œë‹¤.


```python
# ìµœëŒ€ê°’ê³¼ ìµœì†Œê°’ì˜ ë²”ìœ„ë¥¼ ì •í•´ì„œ ì •ê·œí™”í•  ìˆ˜ ìˆëŠ” ë¨¸ì‹ ëŸ¬ë‹
from sklearn.preprocessing import MinMaxScaler

#  ê³µì‹ (X - MIN) / (MAX - MIN)

rfm = ["Recency","Frequency","Monetary"]

normalization = MinMaxScaler()
rfm_normalization = normalization.fit_transform(retail_customer_rfm[rfm])
rfm_normalization = pd.DataFrame(rfm_normalization, columns=rfm)

display(rfm_normalization)
```


<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Recency</th>
      <th>Frequency</th>
      <th>Monetary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.958702</td>
      <td>0.000000</td>
      <td>0.285262</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.053097</td>
      <td>0.009625</td>
      <td>0.005373</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.684366</td>
      <td>0.007727</td>
      <td>0.003976</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.064897</td>
      <td>0.007727</td>
      <td>0.009180</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.002950</td>
      <td>0.002169</td>
      <td>0.003416</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4100</th>
      <td>0.817109</td>
      <td>0.001220</td>
      <td>0.000654</td>
    </tr>
    <tr>
      <th>4101</th>
      <td>0.530973</td>
      <td>0.000813</td>
      <td>0.000285</td>
    </tr>
    <tr>
      <th>4102</th>
      <td>0.020649</td>
      <td>0.001491</td>
      <td>0.000644</td>
    </tr>
    <tr>
      <th>4103</th>
      <td>0.008850</td>
      <td>0.097330</td>
      <td>0.007525</td>
    </tr>
    <tr>
      <th>4104</th>
      <td>0.123894</td>
      <td>0.009353</td>
      <td>0.006777</td>
    </tr>
  </tbody>
</table>
<p>4105 rows Ã— 3 columns</p>
</div>


### ë°ì´í„° ë§ˆì´ë‹
- ëŒ€ê·œëª¨ë¡œ ì €ì¥ëœ ë°ì´í„°ì•ˆì—ì„œ ì²´ê³„ì ì´ê³  ìë™ì ìœ¼ë¡œ í†µê³„ì  ê·œì¹™ì´ë‚˜ ì§œì„ ë˜ëŠ” íŒ¨í„´ì„ ë¶„ì„í•˜ì—¬, ê°€ì¹˜ìˆëŠ” ì •ë³´ë¥¼ ë¹¼ë‚´ëŠ” ê³¼ì •ì´ë‹¤.

### í´ëŸ¬ìŠ¤í„° ë¶„ì„(Cluster analysis)
- ì£¼ì–´ì§„ ë°ì´í„°ë“¤ì˜ íŠ¹ì„±ì„ ê³ ë ¤í•´ ë°ì´í„° ì§‘ë‹¨ì„ ì •ì˜í•˜ê³  ë°ì´í„° ì§‘ë‹¨ì„ ëŒ€í‘œí•  ìˆ˜ ìˆëŠ” ëŒ€í‘œì ì„ ì°¾ëŠ” ê²ƒìœ¼ë¡œ ë°ì´í„° ë§ˆì´ë‹ì˜ í•œ ë°©ë²•ì´ë‹¤.
- í´ëŸ¬ìŠ¤í„°ë€ ë¹„ìŠ·í•œ íŠ¹ì„±ì„ ê°€ì§„ ë°ì´í„°ë“¤ì˜ ì§‘ë‹¨ì´ê³  ë°ì´í„°ì˜ ì„±ê²©ì— ë”°ë¼ ì—¬ëŸ¬ í´ëŸ¬ìŠ¤í„°(ì§‘ë‹¨)ìœ¼ë¡œ ë‚˜ë‰  ìˆ˜ ìˆë‹¤.
- ë¨¸ì‹ ëŸ¬ë‹ì„ ì‚¬ìš©í•˜ì—¬ ë¶„ì„í•  ìˆ˜ ìˆìœ¼ë©°, ë¶„ë¦¬í•  í´ëŸ¬ìŠ¤í„° ê°œìˆ˜ë¥¼ ì•Œë ¤ì¤˜ì•¼ í•œë‹¤.  
ì´ ë•Œ, KElbowVisualizerë¥¼ ì‚¬ìš©í•´ì„œ ìµœì ì˜ í´ëŸ¬ìŠ¤í„° ê°œìˆ˜(elbow)ë¥¼ ë¨¼ì € ì•Œì•„ë‚¼ ìˆ˜ ìˆë‹¤.

### ë³‘í•© ì§‘ë‹¨ ì•Œê³ ë¦¬ì¦˜(Agglomerative clustering)
- ì ê³¼ ì  ì‚¬ì´ì˜ ê±°ë¦¬ê°’ì„ ì‚¬ìš©í•˜ì—¬ ìƒ˜í”Œ ë°ì´í„°ì˜ í´ëŸ¬ìŠ¤í„° ìŒì„ ë°˜ë³µì ìœ¼ë¡œ ë³‘í•©í•œë‹¤.
- ì „ë‹¬ë°›ì€ í´ëŸ¬ìŠ¤í„° ê°œìˆ˜ì™€ ì¼ì¹˜í•  ë•Œ ì¢…ë£Œí•œë‹¤.

![image](https://github.com/SilverSharkDeveloper/Data-Analysis/assets/129861299/18b148ef-3f82-40dd-8fcd-4572a404f365)


```python
# conda install -c districtdatalabs yellowbrick
from yellowbrick.cluster import KElbowVisualizer
from sklearn.cluster import AgglomerativeClustering

model = AgglomerativeClustering()

# k_elbow_visualizer = KElbowVisualizer(model, k=(3, 9), timings=True)
k_elbow_visualizer = KElbowVisualizer(model, k=(2, 9), timings=False)
k_elbow_visualizer.fit(rfm_normalization)

k_elbow_visualizer.show()

#->scoreëŠ” ì§‘ë‹¨ê°„ì˜ ì‘ì§‘ë„ë¥¼ ë‚˜íƒ€ë‚´ê³  këŠ” ì§‘ë‹¨ê°¯ìˆ˜ë¥¼ ë‚˜íƒ€ë‚´ëŠ”ë° ì‘ì§‘ë„ëŠ” ë‚®ì„ìˆ˜ë¡ êµ°ì§‘í™”ê°€ ì˜ë˜ê³ , ì§‘ë‹¨ê°¯ìˆ˜ëŠ” ë§ì„ìˆ˜ë¡ ì¢‹ì§€ë§Œ 
#ì§‘ë‹¨ì´ ë§ì•„ì§€ë©´ ëª¨ë¸ í•™ìŠµì‹œ ì„±ëŠ¥ì´ ë§¤ìš° ë–¨ì–´ì§€ë¯€ë¡œ ê¸°ìš¸ê¸°ê°€ í™• ì¤„ê¸°ì „ ì¦‰ ì§‘ë‹¨ì˜ ê°¯ìˆ˜ê°€ ëŠ˜ì–´ë‚œë‹¤ê³ í•´ì„œ ì‘ì§‘ë„ê°€ í¬ê²Œ ì¤„ì–´ë“¤ì§€ ì•ŠëŠ” ì§€ì 
#ê·¸ ì§€ì ì—ì„œì˜ kê°’ì´ ë¶„ë¥˜í•  í´ëŸ¬ìŠ¤í„° ê°¯ìˆ˜ë¡œ ì í•©í•˜ë‹¤ê³  íŒë‹¨í•œë‹¤.
```

![output_25_0](https://github.com/SilverSharkDeveloper/Data-Analysis/assets/129861299/4c6b5321-c2ee-4264-bcb5-1996bfff7e35)







    <Axes: title={'center': 'Distortion Score Elbow for AgglomerativeClustering Clustering'}, xlabel='k', ylabel='distortion score'>




```python
#í´ëŸ¬ìŠ¤í„° 4ê°œë¡œ êµ°ì§‘í™”
agglomerative_clustering = AgglomerativeClustering(n_clusters=4).fit(rfm_normalization)

#ê²°ê³¼ ê°’ rfm dfì— ë„£ê³  í™•ì¸í•˜ê¸°
rfm_normalization.loc[:, 'cluster'] = agglomerative_clustering.labels_
rfm_normalization.loc[:, 'cluster'].value_counts()
```




    cluster
    0    2510
    1     649
    2     489
    3     457
    Name: count, dtype: int64



### ì‹œê°í™”
- matplotlibë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ì‹œê°í™”í•  ìˆ˜ ìˆê³  ì´ë¥¼ í†µí•´ í•œ ëˆˆì— ë³¼ ìˆ˜ ì—†ëŠ” ë§ì€ ë°ì´í„°ë¥¼ í•œ ëˆˆì— ë³¼ ìˆ˜ ìˆë‹¤.
- ë°ì´í„° ë¶„ì„ì— ëŒ€í•œ ì „ë¬¸ ì§€ì‹ì´ ì—†ëŠ” ì¼ë°˜ì¸ë„ ì´í•´í•  ìˆ˜ ìˆë‹¤.
- ë™ì¼í•œ í†µê³„ë¥¼ ê°€ì§€ê³  ìˆë”ë¼ë„, ì‹œê°í™” ì‹œ ë³€í™”ë‚˜ íŒ¨í„´ì´ ë‹¤ë¥¼ ìˆ˜ ìˆë‹¤.


```python
import matplotlib.pyplot as plt
import seaborn as sns

# Recency : ì–¼ë§ˆë‚˜ ìµœê·¼ì— êµ¬ë§¤í–ˆëŠ”ê°€
# Frequency : ì–¼ë§ˆë‚˜ ìì£¼ êµ¬ë§¤í–ˆëŠ”ê°€
# Monetary : ì–¼ë§ˆë‚˜ ë§ì€ ê¸ˆì•¡ì„ ì§€ì¶œí–ˆëŠ”ê°€
titles = ['Recency', 'Frequency', 'Monetary']

# í´ëŸ¬ìŠ¤í„°(ì§‘ë‹¨) ê°œìˆ˜
k = 4

# ê° í•­ëª©ë³„
for title in titles:
    plt.figure(figsize=(5, 5))
    
    # ì§‘ë‹¨ ë³„
    for i in range(k):
#     scatter: ì‚°ì ë„(ë¶„í¬ë„)
        plt.scatter(rfm_normalization.loc[rfm_normalization['cluster'] == i, 'cluster'], 
                    rfm_normalization.loc[rfm_normalization['cluster'] == i, title], 
                    label=f'cluster {i}')

#     ìƒ‰ìƒë³„ ì œëª©(label) í‘œì‹œ
    plt.legend()
    plt.title(title, size=15)
    plt.xlabel('cluster', size=12)
    plt.ylabel(title, size=12)
    plt.show()   
```


    

    
![output_28_0](https://github.com/SilverSharkDeveloper/Data-Analysis/assets/129861299/efa1b375-3db0-473f-b60c-3b86473bf23f)


![output_28_1](https://github.com/SilverSharkDeveloper/Data-Analysis/assets/129861299/01c9070d-54b9-460a-9d22-1d20c90d21cc)

    
![output_28_2](https://github.com/SilverSharkDeveloper/Data-Analysis/assets/129861299/73b93560-9d98-4ed0-bda0-06e26601d004)


### boxplot
- ë°ì´í„°ì˜ ë¶„í¬ì™€ ì´ìƒì¹˜ë¥¼ í•œ ë²ˆì— ë³¼ ìˆ˜ ìˆìœ¼ë©°, ì„œë¡œ ë‹¤ë¥¸ ì§‘ë‹¨ì„ ì‰½ê²Œ ë¹„êµí•  ìˆ˜ ìˆëŠ” ì°¨íŠ¸ì´ë‹¤.
<div style="display: flex">
    <img src="./images/boxplot2.png" width="400" style="margin-left: 20px">
    <img src="./images/boxplot1.png" width="400" style="margin-left: 20px">
<div>
    
> ìƒì(Box): ìƒìì˜ ì•„ë«ë¶€ë¶„(Q1 ë˜ëŠ” 25th ë°±ë¶„ìœ„ìˆ˜)ì™€ ìœ—ë¶€ë¶„(Q3 ë˜ëŠ” 75th ë°±ë¶„ìœ„ìˆ˜)ì€ ë°ì´í„°ì˜ ì¤‘ê°„ 50% ë²”ìœ„ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ìƒìì˜ ë†’ì´ëŠ” ì´ ë²”ìœ„ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.  

> ìˆ˜ì—¼(Whiskers): ìƒì ìœ„ì™€ ì•„ë˜ì— ìˆëŠ” ì„ ì€ ë°ì´í„°ì˜ ìµœì†Ÿê°’ê³¼ ìµœëŒ“ê°’ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ë³´í†µ, ìˆ˜ì—¼ì˜ ê¸¸ì´ëŠ” ë°•ìŠ¤ì˜ ë†’ì´ì˜ 1.5ë°° ë²”ìœ„ ì´ë‚´ì˜ ê°’ë“¤ë¡œ ì •í•´ì§‘ë‹ˆë‹¤. ë²”ìœ„ë¥¼ ë²—ì–´ë‚˜ëŠ” ë°ì´í„°ëŠ” ì´ìƒì¹˜ë¡œ í‘œì‹œë©ë‹ˆë‹¤.  

> ì¤‘ì•™ê°’(Median): ìƒì ë‚´ë¶€ì— ìˆëŠ” ê°€ë¡œì„ ì€ ë°ì´í„°ì˜ ì¤‘ì•™ê°’ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.  

> ì´ìƒì¹˜(Outliers): ìˆ˜ì—¼ ë°”ê¹¥ì— ìˆëŠ” ì ë“¤ì€ ì´ìƒì¹˜ë¡œ ê°„ì£¼ë˜ë©°, ì£¼ì–´ì§„ ë°ì´í„° ì§‘í•©ì—ì„œ ë‹¤ë¥¸ ê°’ë“¤ê³¼ í¬ê²Œ ë‹¤ë¥¸ ë°ì´í„° í¬ì¸íŠ¸ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.


```python
titles = ['Recency', 'Frequency', 'Monetary']

for title in titles:
    plt.figure(figsize=(5, 5))
    sns.boxplot(x=rfm_normalization.cluster, y=rfm_normalization[title], palette='muted')
    plt.title(title)
    plt.show()
```

![output_30_0](https://github.com/SilverSharkDeveloper/Data-Analysis/assets/129861299/16ba934d-81fe-46c8-a2ab-33e324a7fa08)

![output_30_1](https://github.com/SilverSharkDeveloper/Data-Analysis/assets/129861299/09288419-1787-4cd8-88f3-eb3f5d956a4a)

![output_30_2](https://github.com/SilverSharkDeveloper/Data-Analysis/assets/129861299/7179d498-4541-4d00-b134-f3b9676c71a0)


### ë°•ìŠ¤ ê·¸ë˜í”„ì—ì„œ ì´ìƒì¹˜ë¡œ íŒë‹¨í•œ ê°’ì€ ëª¨ë‘ ì¤‘ì•™ê°’ìœ¼ë¡œ ëŒ€ì²´


```python
for i in range(4):
    rfm_normalization.loc[rfm_normalization[(
        rfm_normalization["cluster"]==i)&(
        rfm_normalization["Frequency"]>0.035)].index,"Frequency"]= \
    rfm_normalization[rfm_normalization["cluster"]==i]["Frequency"].median()
    rfm_normalization.loc[rfm_normalization[(
        rfm_normalization["cluster"]==i)&(
        rfm_normalization["Monetary"]>0.02)].index,"Monetary"]=\
    rfm_normalization[rfm_normalization["cluster"]==i]["Monetary"].median()

```


```python
titles = ['Recency', 'Frequency', 'Monetary']

for title in titles:
    plt.figure(figsize=(5, 5))
    sns.boxplot(x=rfm_normalization.cluster, y=rfm_normalization[title], palette='muted')
    plt.title(title)
    plt.show()
```

![output_33_0](https://github.com/SilverSharkDeveloper/Data-Analysis/assets/129861299/a050e225-a3a5-45d5-98c3-d5ceb090a6b5)


![output_33_1](https://github.com/SilverSharkDeveloper/Data-Analysis/assets/129861299/7dc3678e-6d62-4ebb-8845-56646428b3de)


![output_33_2](https://github.com/SilverSharkDeveloper/Data-Analysis/assets/129861299/510dd81a-06e9-4897-8a79-ddd84f09fa12)

- R, F, M ì ìˆ˜ëŠ” 1~4ë¡œ ê³„ì‚°í•¨.
- ì—¬ê¸°ì„œëŠ” ìµœê·¼ êµ¬ë§¤ë¥¼ ë” ì¤‘ìš”í•˜ë‹¤ê³  ê°€ì •í•œë‹¤.
> Cluster0: VIP, (4, 4, 4) = 12  
Cluster1: GOLD, (3, 3, 3) = 9  
Cluster2: BRONZE, (1, 1, 1) = 3  
Cluster3: SILVER (2, 2, 2) = 6  

### ì›ë³¸ ê³ ê° rfm ë°ì´í„°ì— ì •ë³´ ì¶”ê°€


```python
retail_customer_rfm['cluster'] = rfm_normalization['cluster'].replace([0, 1, 2, 3], ['VIP', 'GOLD', 'BRONZE', 'SILVER'])
retail_customer_rfm
```




<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Customer ID</th>
      <th>Recency</th>
      <th>Frequency</th>
      <th>Monetary</th>
      <th>cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12346.0</td>
      <td>4643</td>
      <td>1</td>
      <td>77183.60</td>
      <td>BRONZE</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12349.0</td>
      <td>4336</td>
      <td>72</td>
      <td>1457.55</td>
      <td>VIP</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12354.0</td>
      <td>4550</td>
      <td>58</td>
      <td>1079.40</td>
      <td>BRONZE</td>
    </tr>
    <tr>
      <th>3</th>
      <td>12356.0</td>
      <td>4340</td>
      <td>58</td>
      <td>2487.43</td>
      <td>VIP</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12358.0</td>
      <td>4319</td>
      <td>17</td>
      <td>928.06</td>
      <td>VIP</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4100</th>
      <td>18280.0</td>
      <td>4595</td>
      <td>10</td>
      <td>180.60</td>
      <td>BRONZE</td>
    </tr>
    <tr>
      <th>4101</th>
      <td>18281.0</td>
      <td>4498</td>
      <td>7</td>
      <td>80.82</td>
      <td>SILVER</td>
    </tr>
    <tr>
      <th>4102</th>
      <td>18282.0</td>
      <td>4325</td>
      <td>12</td>
      <td>178.05</td>
      <td>VIP</td>
    </tr>
    <tr>
      <th>4103</th>
      <td>18283.0</td>
      <td>4321</td>
      <td>719</td>
      <td>2039.58</td>
      <td>VIP</td>
    </tr>
    <tr>
      <th>4104</th>
      <td>18287.0</td>
      <td>4360</td>
      <td>70</td>
      <td>1837.28</td>
      <td>VIP</td>
    </tr>
  </tbody>
</table>
<p>4105 rows Ã— 5 columns</p>
</div>



### RFM í´ëŸ¬ìŠ¤í„° ë°ì´í„° ì‹œê°í™”


```python
order = ['VIP', 'GOLD', 'BRONZE', 'SILVER']
sns.countplot(x='cluster', data=retail_customer_rfm, palette='muted', order=order)
```




    <Axes: xlabel='cluster', ylabel='count'>



![output_38_1](https://github.com/SilverSharkDeveloper/Data-Analysis/assets/129861299/f704029d-48c1-44f2-8d92-c1c81c253a07)


    


## ê³ ê° ì •ë³´ ë°ì´í„°ê°€ ìˆëŠ” í…Œì´ë¸”ì´ ìˆë‹¤ë©´ ì¡°ì¸í•´ ê³ ê°ì˜ ë‚˜ì´, ê²°í˜¼ì—¬ë¶€, ìë…€ ìˆ˜ ë“±ìœ¼ë¡œ ë‹¤ì–‘í•˜ê²Œ í´ëŸ¬ìŠ¤í„°ë¥¼ ì‹œê°í™” í•  ìˆ˜ ìˆë‹¤.
